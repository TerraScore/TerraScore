<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survey Report — {{.ParcelLabel}}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; color: #1a1a1a; line-height: 1.6; padding: 2rem; max-width: 900px; margin: 0 auto; }
        .header { border-bottom: 3px solid #059669; padding-bottom: 1rem; margin-bottom: 2rem; }
        .header h1 { font-size: 1.5rem; color: #059669; }
        .header p { color: #6b7280; font-size: 0.875rem; }
        .section { margin-bottom: 2rem; }
        .section h2 { font-size: 1.125rem; color: #374151; border-bottom: 1px solid #e5e7eb; padding-bottom: 0.5rem; margin-bottom: 1rem; }
        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; }
        .info-item { background: #f9fafb; padding: 0.75rem; border-radius: 0.5rem; }
        .info-item label { display: block; font-size: 0.75rem; color: #6b7280; text-transform: uppercase; letter-spacing: 0.05em; }
        .info-item span { font-weight: 600; }
        .qa-score { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; border-radius: 9999px; font-weight: 700; font-size: 1.125rem; }
        .qa-passed { background: #d1fae5; color: #065f46; }
        .qa-flagged { background: #fef3c7; color: #92400e; }
        .qa-failed { background: #fee2e2; color: #991b1b; }
        .responses-table { width: 100%; border-collapse: collapse; }
        .responses-table th, .responses-table td { text-align: left; padding: 0.5rem 0.75rem; border-bottom: 1px solid #e5e7eb; font-size: 0.875rem; }
        .responses-table th { background: #f9fafb; font-weight: 600; color: #374151; }
        .photo-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; }
        .photo-grid img { width: 100%; height: 200px; object-fit: cover; border-radius: 0.5rem; border: 1px solid #e5e7eb; }
        .photo-grid .caption { font-size: 0.75rem; color: #6b7280; margin-top: 0.25rem; }
        .footer { margin-top: 3rem; padding-top: 1rem; border-top: 1px solid #e5e7eb; font-size: 0.75rem; color: #9ca3af; text-align: center; }
    </style>
</head>
<body>
    <div class="header">
        <h1>TerraScore Survey Report</h1>
        <p>Generated on {{.GeneratedAt}}</p>
    </div>

    <div class="section">
        <h2>Parcel Information</h2>
        <div class="info-grid">
            <div class="info-item">
                <label>Label</label>
                <span>{{.ParcelLabel}}</span>
            </div>
            <div class="info-item">
                <label>District</label>
                <span>{{.ParcelDistrict}}</span>
            </div>
            <div class="info-item">
                <label>State</label>
                <span>{{.ParcelState}}</span>
            </div>
            <div class="info-item">
                <label>Survey Type</label>
                <span>{{.SurveyType}}</span>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>Survey Details</h2>
        <div class="info-grid">
            <div class="info-item">
                <label>Job ID</label>
                <span>{{.JobID}}</span>
            </div>
            <div class="info-item">
                <label>Agent</label>
                <span>{{.AgentName}}</span>
            </div>
            <div class="info-item">
                <label>Submitted</label>
                <span>{{.SubmittedAt}}</span>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>QA Score</h2>
        <div class="qa-score qa-{{.QAStatus}}">
            {{.QAScore}} — {{.QAStatus}}
        </div>
        <p style="margin-top: 0.5rem; font-size: 0.875rem; color: #6b7280;">{{.QANotes}}</p>
    </div>

    <div class="section">
        <h2>Checklist Responses</h2>
        <pre style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem; font-size: 0.8rem; overflow-x: auto; white-space: pre-wrap;">{{.Responses}}</pre>
    </div>

    {{if .MediaURLs}}
    <div class="section">
        <h2>Photos &amp; Media</h2>
        <div class="photo-grid">
            {{range .MediaURLs}}
            <div>
                {{if eq .MediaType "image/jpeg" "image/png" "image/webp"}}
                <img src="{{.URL}}" alt="Step {{.StepID}}" loading="lazy">
                {{else}}
                <div style="height:200px;background:#f3f4f6;border-radius:0.5rem;display:flex;align-items:center;justify-content:center;border:1px solid #e5e7eb;">
                    <span style="color:#9ca3af;">{{.MediaType}}</span>
                </div>
                {{end}}
                <div class="caption">Step: {{.StepID}}</div>
            </div>
            {{end}}
        </div>
    </div>
    {{end}}

    <div class="footer">
        <p>TerraScore — Land Intelligence Platform</p>
        <p>This report was auto-generated. For questions, contact support.</p>
    </div>
</body>
</html>
